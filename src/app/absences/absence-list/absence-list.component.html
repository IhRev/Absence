<div class="container">
  <div class="manage-panel" *ngIf="!isProcessing">
    <div
      class="msg-box"
      [ngClass]="{
        'success-msg': isSuccess && message,
        'error-msg': !isSuccess && message
      }"
    >
      <span class="msg">{{ message }}</span>
      <button *ngIf="message" (click)="closeMessage()" class="close-btn">
        <i class="fa-solid fa-xmark"></i>
      </button>
    </div>

    <div class="btns">
      <button class="filter-btn" (click)="showFilters()">
        <i class="fa-solid fa-filter"></i>
      </button>

      <button class="add-btn" (click)="openForm()">
        <i class="fa-solid fa-plus"></i>
      </button>
    </div>
  </div>

  <div class="grid-list" *ngIf="!isProcessing">
    <div class="grid-header grid-row">
      <span>#</span>
      <span>Name</span>
      <span>Type</span>
      <span>Start Date</span>
      <span>End Date</span>
      <span>Actions</span>
    </div>
    <div class="grid-row grid-item-row" *ngFor="let absence of absences">
      <span data-label="#">{{ absence.num }}</span>
      <span data-label="Name">{{ absence.name }}</span>
      <span data-label="Type">{{ absence.type.name }}</span>
      <span data-label="Start Date">{{
        absence.startDate | date : "dd.MM.yyyy"
      }}</span>
      <span data-label="End Date">{{
        absence.endDate | date : "dd.MM.yyyy"
      }}</span>
      <span data-label="Actions">
        <div class="action-buttons">
          <button class="delete-btn" (click)="delete(absence.id)">
            <i class="fa-solid fa-trash"></i>
          </button>
          <button class="edit-btn" (click)="openForm(absence)">
            <i class="fa-solid fa-pen"></i>
          </button>
        </div>
      </span>
    </div>
  </div>

  <i class="fa-solid fa-spinner fa-spin load-icon" *ngIf="isProcessing"></i>
</div>

<app-absence-form
  (closeModal)="closeForm()"
  (submitCreate)="create($event)"
  (submitEdit)="edit($event)"
  [isVisible]="isFormOpened"
  [absence]="selectedAbsence"
/>

<app-absence-filters
  (closeModal)="closeFilters()"
  (submitModal)="applyFilters($event)"
  [isVisible]="filtersOpened"
/>
